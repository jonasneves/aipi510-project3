/opt/hostedtoolcache/Python/3.11.14/arm64/lib/python3.11/site-packages/mlflow/tracking/_tracking_service/utils.py:177: FutureWarning: The filesystem tracking backend (e.g., './mlruns') will be deprecated in February 2026. Consider transitioning to a database backend (e.g., 'sqlite:///mlflow.db') to take advantage of the latest MLflow features. See https://github.com/mlflow/mlflow/issues/18534 for more details and migration guidance.
  return FileStore(store_uri, store_uri)
2025/12/06 22:57:33 INFO mlflow.tracking.fluent: Experiment with name 'salary_prediction' does not exist. Creating a new experiment.
2025-12-06 22:57:33,308 - DataMerger - INFO - Data merger initialized. Log file: logs/data_merge_20251206_225733.log
2025-12-06 22:57:33,308 - DataMerger - INFO - Applying training profile: all
2025-12-06 22:57:33,308 - DataMerger - INFO -   Description: Train on all available sources (H1B + LinkedIn + Adzuna)
2025-12-06 22:57:33,308 - DataMerger - INFO -   h1b: enabled
2025-12-06 22:57:33,308 - DataMerger - INFO -   adzuna: enabled
2025-12-06 22:57:33,308 - DataMerger - INFO -   linkedin: enabled
--- Model Training ---

MLFlow tracking URI: file:./mlruns
MLFlow experiment: salary_prediction

Loading data...

Using training profile: all
Loaded 29674 records from merged data

Filtering to recent data (last 2 years: 2024-2025)
  Kept 24662 / 29674 records (83.1%)
  Renaming location_state to worksite_state for feature engineering

Engineering features...

Prepared 24374 samples with 30 features
Target column: annual_salary

Creating train/test split...
  Train: 17061 samples (70.0%)
  Val:   3656 samples (15.0%)
  Test:  3657 samples (15.0%)

Training XGBoost model...
MLFlow run ID: 673ee5d5d074473882df9c2c6c899bbc
Training XGBoost salary prediction model...
Training samples: 17061
Features: 29
Validation samples: 3656
[0]	validation_0-rmse:98564.87106	validation_1-rmse:98264.43721
[1]	validation_0-rmse:96030.85294	validation_1-rmse:95778.22192
[2]	validation_0-rmse:91805.01284	validation_1-rmse:91610.20524
[3]	validation_0-rmse:88043.77703	validation_1-rmse:87874.67459
[4]	validation_0-rmse:85751.10515	validation_1-rmse:85635.33910
[5]	validation_0-rmse:83000.10804	validation_1-rmse:82990.74703
[6]	validation_0-rmse:80491.54848	validation_1-rmse:80462.51477
[7]	validation_0-rmse:78521.20914	validation_1-rmse:78598.86142
[8]	validation_0-rmse:76777.60232	validation_1-rmse:76888.07169
[9]	validation_0-rmse:75329.80113	validation_1-rmse:75437.35985
[10]	validation_0-rmse:74151.99238	validation_1-rmse:74319.01464
[11]	validation_0-rmse:72924.21052	validation_1-rmse:73169.74150
[12]	validation_0-rmse:71973.00101	validation_1-rmse:72334.27555
[13]	validation_0-rmse:71133.58646	validation_1-rmse:71516.73486
[14]	validation_0-rmse:70212.12723	validation_1-rmse:70646.95338
[15]	validation_0-rmse:69587.98772	validation_1-rmse:70040.70611
[16]	validation_0-rmse:69121.63545	validation_1-rmse:69648.61221
[17]	validation_0-rmse:68474.21608	validation_1-rmse:69002.64671
[18]	validation_0-rmse:67928.81544	validation_1-rmse:68571.43792
[19]	validation_0-rmse:67621.15684	validation_1-rmse:68307.06196
[20]	validation_0-rmse:67155.78091	validation_1-rmse:67916.27406
[21]	validation_0-rmse:66480.32768	validation_1-rmse:67168.57655
[22]	validation_0-rmse:65957.79853	validation_1-rmse:66586.74277
[23]	validation_0-rmse:65668.42966	validation_1-rmse:66346.88606
[24]	validation_0-rmse:65414.82853	validation_1-rmse:66179.90326
[25]	validation_0-rmse:65088.77807	validation_1-rmse:65909.24353
[26]	validation_0-rmse:64761.28752	validation_1-rmse:65604.70362
[27]	validation_0-rmse:64471.49469	validation_1-rmse:65313.91368
[28]	validation_0-rmse:64294.76749	validation_1-rmse:65180.77673
[29]	validation_0-rmse:64144.19787	validation_1-rmse:65092.63021
[30]	validation_0-rmse:64002.56003	validation_1-rmse:65014.43659
[31]	validation_0-rmse:63899.85460	validation_1-rmse:64965.40699
[32]	validation_0-rmse:63673.52150	validation_1-rmse:64743.19099
[33]	validation_0-rmse:63547.58546	validation_1-rmse:64633.81121
[34]	validation_0-rmse:63039.36299	validation_1-rmse:64105.18237
[35]	validation_0-rmse:62739.69549	validation_1-rmse:63845.66556
[36]	validation_0-rmse:62572.05449	validation_1-rmse:63720.10441
[37]	validation_0-rmse:62349.46051	validation_1-rmse:63497.92660
[38]	validation_0-rmse:62254.06274	validation_1-rmse:63449.32084
[39]	validation_0-rmse:61856.15739	validation_1-rmse:62999.16592
[40]	validation_0-rmse:61565.20652	validation_1-rmse:62713.92845
[41]	validation_0-rmse:61354.40712	validation_1-rmse:62520.26791
[42]	validation_0-rmse:61011.55765	validation_1-rmse:62146.04753
[43]	validation_0-rmse:60639.55168	validation_1-rmse:61778.56062
[44]	validation_0-rmse:60486.03676	validation_1-rmse:61701.47409
[45]	validation_0-rmse:60236.07823	validation_1-rmse:61473.22060
[46]	validation_0-rmse:60150.34678	validation_1-rmse:61407.02277
[47]	validation_0-rmse:60019.53530	validation_1-rmse:61274.27442
[48]	validation_0-rmse:59814.54543	validation_1-rmse:61087.30921
[49]	validation_0-rmse:59698.75378	validation_1-rmse:60991.93087
[50]	validation_0-rmse:59619.03068	validation_1-rmse:60923.72516
[51]	validation_0-rmse:59487.62339	validation_1-rmse:60792.50842
[52]	validation_0-rmse:59170.25514	validation_1-rmse:60498.40737
[53]	validation_0-rmse:59044.74363	validation_1-rmse:60377.06960
[54]	validation_0-rmse:58918.00973	validation_1-rmse:60255.95378
[55]	validation_0-rmse:58831.16054	validation_1-rmse:60178.52679
[56]	validation_0-rmse:58609.82037	validation_1-rmse:59991.16556
[57]	validation_0-rmse:58401.06180	validation_1-rmse:59779.30974
[58]	validation_0-rmse:58317.04808	validation_1-rmse:59700.17484
[59]	validation_0-rmse:58277.16880	validation_1-rmse:59670.35845
[60]	validation_0-rmse:58078.99101	validation_1-rmse:59471.20943
[61]	validation_0-rmse:58003.73292	validation_1-rmse:59404.52204
[62]	validation_0-rmse:57867.10759	validation_1-rmse:59271.29449
[63]	validation_0-rmse:57635.30729	validation_1-rmse:59034.94068
[64]	validation_0-rmse:57524.81653	validation_1-rmse:58916.38220
[65]	validation_0-rmse:57378.47425	validation_1-rmse:58822.78773
[66]	validation_0-rmse:57330.67098	validation_1-rmse:58792.77437
[67]	validation_0-rmse:57239.34072	validation_1-rmse:58741.53199
[68]	validation_0-rmse:57185.75340	validation_1-rmse:58689.98902
[69]	validation_0-rmse:57088.23178	validation_1-rmse:58602.20029
[70]	validation_0-rmse:57006.65407	validation_1-rmse:58525.55009
[71]	validation_0-rmse:56898.51748	validation_1-rmse:58441.00470
[72]	validation_0-rmse:56814.14917	validation_1-rmse:58372.80943
[73]	validation_0-rmse:56666.93916	validation_1-rmse:58222.85686
[74]	validation_0-rmse:56501.38038	validation_1-rmse:58079.29215
[75]	validation_0-rmse:56335.56475	validation_1-rmse:57887.64694
[76]	validation_0-rmse:56230.57537	validation_1-rmse:57796.79354
[77]	validation_0-rmse:56055.54246	validation_1-rmse:57626.41413
[78]	validation_0-rmse:55874.15349	validation_1-rmse:57430.00966
[79]	validation_0-rmse:55721.42923	validation_1-rmse:57297.91734
[80]	validation_0-rmse:55581.40785	validation_1-rmse:57169.27523
[81]	validation_0-rmse:55505.99069	validation_1-rmse:57094.01137
[82]	validation_0-rmse:55469.89069	validation_1-rmse:57069.10546
[83]	validation_0-rmse:55373.57614	validation_1-rmse:57012.06461
[84]	validation_0-rmse:55216.92800	validation_1-rmse:56847.89251
[85]	validation_0-rmse:55196.27806	validation_1-rmse:56840.50495
[86]	validation_0-rmse:55147.74380	validation_1-rmse:56781.91023
[87]	validation_0-rmse:55108.93582	validation_1-rmse:56755.68776
[88]	validation_0-rmse:54936.33214	validation_1-rmse:56591.34472
[89]	validation_0-rmse:54814.42472	validation_1-rmse:56456.25181
[90]	validation_0-rmse:54669.03946	validation_1-rmse:56310.04429
[91]	validation_0-rmse:54534.38104	validation_1-rmse:56182.72195
[92]	validation_0-rmse:54432.10398	validation_1-rmse:56051.36064
[93]	validation_0-rmse:54376.85908	validation_1-rmse:56025.42106
[94]	validation_0-rmse:54258.72067	validation_1-rmse:55896.29828
[95]	validation_0-rmse:54187.78405	validation_1-rmse:55833.28944
[96]	validation_0-rmse:53928.43443	validation_1-rmse:55588.27971
[97]	validation_0-rmse:53873.26145	validation_1-rmse:55541.20145
[98]	validation_0-rmse:53853.44635	validation_1-rmse:55529.38571
[99]	validation_0-rmse:53769.66734	validation_1-rmse:55412.77396
[100]	validation_0-rmse:53749.79532	validation_1-rmse:55400.85560
[101]	validation_0-rmse:53653.22999	validation_1-rmse:55348.62373
[102]	validation_0-rmse:53631.21722	validation_1-rmse:55333.33234
[103]	validation_0-rmse:53550.15807	validation_1-rmse:55239.43693
[104]	validation_0-rmse:53496.69425	validation_1-rmse:55184.04820
[105]	validation_0-rmse:53419.17250	validation_1-rmse:55093.29045
[106]	validation_0-rmse:53406.78221	validation_1-rmse:55090.26703
[107]	validation_0-rmse:53300.99303	validation_1-rmse:54999.84680
[108]	validation_0-rmse:53265.18627	validation_1-rmse:54989.38714
[109]	validation_0-rmse:53198.06682	validation_1-rmse:54935.45430
[110]	validation_0-rmse:53145.92150	validation_1-rmse:54888.52196
[111]	validation_0-rmse:53053.57757	validation_1-rmse:54838.28676
[112]	validation_0-rmse:52876.95047	validation_1-rmse:54644.24601
[113]	validation_0-rmse:52836.39852	validation_1-rmse:54620.90504
[114]	validation_0-rmse:52793.43868	validation_1-rmse:54602.11216
[115]	validation_0-rmse:52755.18361	validation_1-rmse:54593.43605
[116]	validation_0-rmse:52710.40870	validation_1-rmse:54549.52439
[117]	validation_0-rmse:52548.59172	validation_1-rmse:54393.26824
[118]	validation_0-rmse:52500.74534	validation_1-rmse:54374.99885
[119]	validation_0-rmse:52445.67256	validation_1-rmse:54338.04196
[120]	validation_0-rmse:52371.26139	validation_1-rmse:54256.35414
[121]	validation_0-rmse:52289.86493	validation_1-rmse:54175.54676
[122]	validation_0-rmse:52165.21896	validation_1-rmse:54072.51111
[123]	validation_0-rmse:52110.24328	validation_1-rmse:53981.34340
[124]	validation_0-rmse:52039.38770	validation_1-rmse:53914.75273
[125]	validation_0-rmse:51996.77221	validation_1-rmse:53879.25544
[126]	validation_0-rmse:51960.24324	validation_1-rmse:53859.92440
[127]	validation_0-rmse:51934.93389	validation_1-rmse:53839.75143
[128]	validation_0-rmse:51917.50170	validation_1-rmse:53837.85823
[129]	validation_0-rmse:51845.58440	validation_1-rmse:53754.53740
[130]	validation_0-rmse:51703.34784	validation_1-rmse:53582.71233
[131]	validation_0-rmse:51636.54005	validation_1-rmse:53524.47874
[132]	validation_0-rmse:51585.21830	validation_1-rmse:53469.26355
[133]	validation_0-rmse:51569.15792	validation_1-rmse:53465.46251
[134]	validation_0-rmse:51543.05430	validation_1-rmse:53462.83172
[135]	validation_0-rmse:51450.56555	validation_1-rmse:53339.91620
[136]	validation_0-rmse:51389.21037	validation_1-rmse:53290.34877
[137]	validation_0-rmse:51355.81213	validation_1-rmse:53257.59636
[138]	validation_0-rmse:51293.10491	validation_1-rmse:53175.80692
[139]	validation_0-rmse:51229.73447	validation_1-rmse:53141.07096
[140]	validation_0-rmse:51168.56511	validation_1-rmse:53090.59855
[141]	validation_0-rmse:51135.69780	validation_1-rmse:53070.84036
[142]	validation_0-rmse:51103.17375	validation_1-rmse:53041.68959
[143]	validation_0-rmse:51076.89266	validation_1-rmse:53031.33763
[144]	validation_0-rmse:51063.35922	validation_1-rmse:53020.91638
[145]	validation_0-rmse:51018.02545	validation_1-rmse:52984.89692
[146]	validation_0-rmse:50990.74321	validation_1-rmse:52956.88030
[147]	validation_0-rmse:50951.11925	validation_1-rmse:52929.20922
[148]	validation_0-rmse:50923.40725	validation_1-rmse:52909.27165
[149]	validation_0-rmse:50887.34702	validation_1-rmse:52873.41311
[150]	validation_0-rmse:50815.53702	validation_1-rmse:52836.29620
[151]	validation_0-rmse:50805.80510	validation_1-rmse:52830.11640
[152]	validation_0-rmse:50737.83797	validation_1-rmse:52790.06023
[153]	validation_0-rmse:50670.22429	validation_1-rmse:52733.08647
[154]	validation_0-rmse:50662.61027	validation_1-rmse:52730.50826
[155]	validation_0-rmse:50597.63545	validation_1-rmse:52666.44034
[156]	validation_0-rmse:50567.82051	validation_1-rmse:52649.41415
[157]	validation_0-rmse:50542.41347	validation_1-rmse:52631.45770
[158]	validation_0-rmse:50523.31486	validation_1-rmse:52632.63237
[159]	validation_0-rmse:50476.15460	validation_1-rmse:52569.93696
[160]	validation_0-rmse:50416.21485	validation_1-rmse:52499.65885
[161]	validation_0-rmse:50380.90252	validation_1-rmse:52470.04767
[162]	validation_0-rmse:50346.50510	validation_1-rmse:52449.61950
[163]	validation_0-rmse:50340.50184	validation_1-rmse:52448.78373
[164]	validation_0-rmse:50293.83804	validation_1-rmse:52413.30826
[165]	validation_0-rmse:50271.64948	validation_1-rmse:52391.53866
[166]	validation_0-rmse:50221.41118	validation_1-rmse:52355.45635
[167]	validation_0-rmse:50187.35740	validation_1-rmse:52335.58931
[168]	validation_0-rmse:50149.26554	validation_1-rmse:52322.14686
[169]	validation_0-rmse:50099.84083	validation_1-rmse:52268.30717
[170]	validation_0-rmse:50075.37507	validation_1-rmse:52247.65473
[171]	validation_0-rmse:50046.05661	validation_1-rmse:52239.94874
[172]	validation_0-rmse:50004.43178	validation_1-rmse:52216.03170
[173]	validation_0-rmse:49933.87259	validation_1-rmse:52157.55832
[174]	validation_0-rmse:49897.43543	validation_1-rmse:52136.64470
[175]	validation_0-rmse:49881.36669	validation_1-rmse:52135.60336
[176]	validation_0-rmse:49853.84773	validation_1-rmse:52097.63682
[177]	validation_0-rmse:49812.00048	validation_1-rmse:52094.98992
[178]	validation_0-rmse:49778.82630	validation_1-rmse:52053.96907
[179]	validation_0-rmse:49754.34917	validation_1-rmse:52035.70521
[180]	validation_0-rmse:49729.50642	validation_1-rmse:52021.60205
[181]	validation_0-rmse:49709.08415	validation_1-rmse:52000.51876
[182]	validation_0-rmse:49690.91238	validation_1-rmse:51995.40817
[183]	validation_0-rmse:49682.72567	validation_1-rmse:51994.97042
[184]	validation_0-rmse:49655.20722	validation_1-rmse:51978.27860
[185]	validation_0-rmse:49630.41533	validation_1-rmse:51973.37546
[186]	validation_0-rmse:49602.21891	validation_1-rmse:51947.73901
[187]	validation_0-rmse:49587.52269	validation_1-rmse:51945.39101
[188]	validation_0-rmse:49564.72033	validation_1-rmse:51903.20924
[189]	validation_0-rmse:49540.69119	validation_1-rmse:51893.97110
[190]	validation_0-rmse:49534.58761	validation_1-rmse:51889.01892
[191]	validation_0-rmse:49506.87381	validation_1-rmse:51865.94892
[192]	validation_0-rmse:49476.39931	validation_1-rmse:51857.28775
[193]	validation_0-rmse:49458.60985	validation_1-rmse:51842.19804
[194]	validation_0-rmse:49442.27786	validation_1-rmse:51835.45506
[195]	validation_0-rmse:49398.97265	validation_1-rmse:51815.09667
[196]	validation_0-rmse:49368.20051	validation_1-rmse:51776.62926
[197]	validation_0-rmse:49357.27479	validation_1-rmse:51764.93007
[198]	validation_0-rmse:49324.07737	validation_1-rmse:51739.34197
[199]	validation_0-rmse:49302.66159	validation_1-rmse:51719.91225

Training completed!

Training Metrics:
  MAE:  $34,607
  RMSE: $49,303
  R2:   0.7675
  MAPE: 20.25%
  Median AE: $24,640

Validation Metrics:
  MAE:  $35,836
  RMSE: $51,720
  R2:   0.7421
  MAPE: 20.97%
  Median AE: $26,274

Evaluating on test set...

Evaluating on 3657 test samples...

Test Metrics:
  MAE:  $36,463
  RMSE: $53,261
  R2:   0.7277
  MAPE: 21.23%
  Median AE: $26,401

Top 15 Most Important Features:
  year: 0.2388
  company_tier_encoded: 0.0750
  role_architect: 0.0671
  is_entry: 0.0647
  is_staff: 0.0567
  is_principal: 0.0546
  is_secondary_hub: 0.0420
  role_engineer: 0.0282
  is_director: 0.0268
  skill_deep_learning: 0.0257
  estimated_yoe: 0.0255
  role_scientist: 0.0247
  is_manager: 0.0243
  state_clean_encoded: 0.0234
  is_remote_friendly: 0.0218
Model saved to models/salary_model_20251206_225742.pkl

MLFlow run completed: 673ee5d5d074473882df9c2c6c899bbc

Model training complete!
