/opt/hostedtoolcache/Python/3.11.14/arm64/lib/python3.11/site-packages/mlflow/tracking/_tracking_service/utils.py:177: FutureWarning: The filesystem tracking backend (e.g., './mlruns') will be deprecated in February 2026. Consider transitioning to a database backend (e.g., 'sqlite:///mlflow.db') to take advantage of the latest MLflow features. See https://github.com/mlflow/mlflow/issues/18534 for more details and migration guidance.
  return FileStore(store_uri, store_uri)
2025/12/06 22:07:39 INFO mlflow.tracking.fluent: Experiment with name 'salary_prediction' does not exist. Creating a new experiment.
2025-12-06 22:07:39,787 - DataMerger - INFO - Data merger initialized. Log file: logs/data_merge_20251206_220739.log
2025-12-06 22:07:39,787 - DataMerger - INFO - Applying training profile: all
2025-12-06 22:07:39,787 - DataMerger - INFO -   Description: Train on all available sources (H1B + LinkedIn + Adzuna)
2025-12-06 22:07:39,788 - DataMerger - INFO -   h1b: enabled
2025-12-06 22:07:39,788 - DataMerger - INFO -   adzuna: enabled
2025-12-06 22:07:39,788 - DataMerger - INFO -   linkedin: enabled
--- Model Training ---

MLFlow tracking URI: file:./mlruns
MLFlow experiment: salary_prediction

Loading data...

Using training profile: all
Loaded 12254 records from merged data

Filtering to recent data (last 2 years: 2024-2025)
  Kept 12210 / 12254 records (99.6%)
  Renaming location_state to worksite_state for feature engineering

Engineering features...

Prepared 11949 samples with 30 features
Target column: annual_salary

Creating train/test split...
  Train: 8363 samples (70.0%)
  Val:   1793 samples (15.0%)
  Test:  1793 samples (15.0%)

Training XGBoost model...
MLFlow run ID: fc8e65a7e0074e2ea36464d04d4dd03c
Training XGBoost salary prediction model...
Training samples: 8363
Features: 29
Validation samples: 1793
[0]	validation_0-rmse:74244.90842	validation_1-rmse:78477.11118
[1]	validation_0-rmse:72555.43217	validation_1-rmse:76807.03575
[2]	validation_0-rmse:70295.94407	validation_1-rmse:74647.06482
[3]	validation_0-rmse:68348.22354	validation_1-rmse:72743.48023
[4]	validation_0-rmse:67360.13834	validation_1-rmse:71765.91440
[5]	validation_0-rmse:65790.76779	validation_1-rmse:70211.52484
[6]	validation_0-rmse:64370.76029	validation_1-rmse:68842.23909
[7]	validation_0-rmse:63205.46616	validation_1-rmse:67724.59857
[8]	validation_0-rmse:62215.84898	validation_1-rmse:66729.56865
[9]	validation_0-rmse:61366.11609	validation_1-rmse:65776.22874
[10]	validation_0-rmse:60656.76953	validation_1-rmse:65148.50263
[11]	validation_0-rmse:59979.90284	validation_1-rmse:64477.85650
[12]	validation_0-rmse:59392.40819	validation_1-rmse:63929.08458
[13]	validation_0-rmse:58867.33096	validation_1-rmse:63407.65403
[14]	validation_0-rmse:58440.76113	validation_1-rmse:63031.51129
[15]	validation_0-rmse:58072.14529	validation_1-rmse:62793.18248
[16]	validation_0-rmse:57718.41636	validation_1-rmse:62604.85837
[17]	validation_0-rmse:57320.79105	validation_1-rmse:62368.66145
[18]	validation_0-rmse:57018.40530	validation_1-rmse:62102.50081
[19]	validation_0-rmse:56759.85337	validation_1-rmse:61882.77695
[20]	validation_0-rmse:56475.54720	validation_1-rmse:61693.58330
[21]	validation_0-rmse:56259.77101	validation_1-rmse:61623.56714
[22]	validation_0-rmse:56017.70741	validation_1-rmse:61472.47535
[23]	validation_0-rmse:55835.64261	validation_1-rmse:61295.04404
[24]	validation_0-rmse:55662.24166	validation_1-rmse:61157.56275
[25]	validation_0-rmse:55496.25589	validation_1-rmse:61035.81557
[26]	validation_0-rmse:55337.88132	validation_1-rmse:60922.15255
[27]	validation_0-rmse:55139.48079	validation_1-rmse:60828.38844
[28]	validation_0-rmse:55014.10432	validation_1-rmse:60728.68387
[29]	validation_0-rmse:54808.94008	validation_1-rmse:60604.98940
[30]	validation_0-rmse:54685.08947	validation_1-rmse:60552.76839
[31]	validation_0-rmse:54586.96839	validation_1-rmse:60539.00386
[32]	validation_0-rmse:54428.02221	validation_1-rmse:60503.83095
[33]	validation_0-rmse:54307.47019	validation_1-rmse:60428.85023
[34]	validation_0-rmse:54212.65463	validation_1-rmse:60414.94184
[35]	validation_0-rmse:54135.71752	validation_1-rmse:60434.45290
[36]	validation_0-rmse:54056.70234	validation_1-rmse:60370.00289
[37]	validation_0-rmse:53991.25006	validation_1-rmse:60365.81072
[38]	validation_0-rmse:53917.02874	validation_1-rmse:60309.92127
[39]	validation_0-rmse:53793.53091	validation_1-rmse:60248.91387
[40]	validation_0-rmse:53727.01513	validation_1-rmse:60218.69876
[41]	validation_0-rmse:53622.73564	validation_1-rmse:60199.98317
[42]	validation_0-rmse:53553.93516	validation_1-rmse:60171.75280
[43]	validation_0-rmse:53491.43087	validation_1-rmse:60125.11725
[44]	validation_0-rmse:53442.94829	validation_1-rmse:60113.88468
[45]	validation_0-rmse:53389.34544	validation_1-rmse:60117.93256
[46]	validation_0-rmse:53291.73433	validation_1-rmse:60036.59849
[47]	validation_0-rmse:53243.74054	validation_1-rmse:60025.85783
[48]	validation_0-rmse:53177.39029	validation_1-rmse:60013.98954
[49]	validation_0-rmse:53128.81191	validation_1-rmse:60019.33360
[50]	validation_0-rmse:53058.18697	validation_1-rmse:60008.23367
[51]	validation_0-rmse:53002.74319	validation_1-rmse:59977.94825
[52]	validation_0-rmse:52932.36347	validation_1-rmse:59990.51257
[53]	validation_0-rmse:52849.29056	validation_1-rmse:59970.82085
[54]	validation_0-rmse:52793.42176	validation_1-rmse:59981.22440
[55]	validation_0-rmse:52729.68661	validation_1-rmse:59975.41906
[56]	validation_0-rmse:52637.82756	validation_1-rmse:59978.22109
[57]	validation_0-rmse:52608.20861	validation_1-rmse:59973.16202
[58]	validation_0-rmse:52534.57465	validation_1-rmse:59982.98782
[59]	validation_0-rmse:52496.83981	validation_1-rmse:59980.31817
[60]	validation_0-rmse:52466.51716	validation_1-rmse:60018.08930
[61]	validation_0-rmse:52395.51440	validation_1-rmse:60035.23918
[62]	validation_0-rmse:52310.84008	validation_1-rmse:60013.09822
[63]	validation_0-rmse:52249.96108	validation_1-rmse:60032.64836
[64]	validation_0-rmse:52178.91738	validation_1-rmse:60083.95616
[65]	validation_0-rmse:52115.89457	validation_1-rmse:60043.87115
[66]	validation_0-rmse:52091.49973	validation_1-rmse:60029.72477
[67]	validation_0-rmse:52047.71048	validation_1-rmse:60019.04091
[68]	validation_0-rmse:51975.38502	validation_1-rmse:60016.13336
[69]	validation_0-rmse:51948.99209	validation_1-rmse:60035.51519
[70]	validation_0-rmse:51925.47807	validation_1-rmse:60047.27751
[71]	validation_0-rmse:51900.12864	validation_1-rmse:60064.50605
[72]	validation_0-rmse:51848.98743	validation_1-rmse:60108.12274
[73]	validation_0-rmse:51735.66209	validation_1-rmse:60094.36137
[74]	validation_0-rmse:51683.11199	validation_1-rmse:60092.77886
[75]	validation_0-rmse:51621.84577	validation_1-rmse:60126.05207
[76]	validation_0-rmse:51575.64444	validation_1-rmse:60146.64164
[77]	validation_0-rmse:51550.59533	validation_1-rmse:60138.16447
[78]	validation_0-rmse:51494.73929	validation_1-rmse:60183.65916
[79]	validation_0-rmse:51439.11681	validation_1-rmse:60247.26285
[80]	validation_0-rmse:51421.03380	validation_1-rmse:60274.66042
[81]	validation_0-rmse:51344.42445	validation_1-rmse:60299.94024
[82]	validation_0-rmse:51295.48000	validation_1-rmse:60319.02032
[83]	validation_0-rmse:51265.99020	validation_1-rmse:60334.34140
[84]	validation_0-rmse:51215.82287	validation_1-rmse:60366.60145
[85]	validation_0-rmse:51176.93018	validation_1-rmse:60362.22976
[86]	validation_0-rmse:51138.75789	validation_1-rmse:60378.41533
[87]	validation_0-rmse:51116.59201	validation_1-rmse:60395.60896
[88]	validation_0-rmse:51082.85212	validation_1-rmse:60488.78218
[89]	validation_0-rmse:51036.93744	validation_1-rmse:60510.79360
[90]	validation_0-rmse:50984.65321	validation_1-rmse:60545.64500
[91]	validation_0-rmse:50930.29756	validation_1-rmse:60592.83074
[92]	validation_0-rmse:50881.68068	validation_1-rmse:60615.83609
[93]	validation_0-rmse:50856.37502	validation_1-rmse:60659.72515
[94]	validation_0-rmse:50824.23576	validation_1-rmse:60661.80047
[95]	validation_0-rmse:50808.85919	validation_1-rmse:60675.88799
[96]	validation_0-rmse:50795.99663	validation_1-rmse:60676.74646
[97]	validation_0-rmse:50783.43927	validation_1-rmse:60668.53887
[98]	validation_0-rmse:50767.99685	validation_1-rmse:60673.57733
[99]	validation_0-rmse:50729.03503	validation_1-rmse:60663.49207
[100]	validation_0-rmse:50695.48041	validation_1-rmse:60627.75512
[101]	validation_0-rmse:50671.85526	validation_1-rmse:60664.41105
[102]	validation_0-rmse:50622.54486	validation_1-rmse:60656.04012
[103]	validation_0-rmse:50575.38592	validation_1-rmse:60694.58976
[104]	validation_0-rmse:50552.61136	validation_1-rmse:60662.69244
[105]	validation_0-rmse:50526.05860	validation_1-rmse:60652.20413
[106]	validation_0-rmse:50493.49660	validation_1-rmse:60636.87719
[107]	validation_0-rmse:50480.28921	validation_1-rmse:60667.75544
[108]	validation_0-rmse:50448.35594	validation_1-rmse:60687.48829
[109]	validation_0-rmse:50423.80874	validation_1-rmse:60683.87479
[110]	validation_0-rmse:50391.16088	validation_1-rmse:60650.04749
[111]	validation_0-rmse:50367.38063	validation_1-rmse:60679.79335
[112]	validation_0-rmse:50318.70263	validation_1-rmse:60676.85986
[113]	validation_0-rmse:50301.26040	validation_1-rmse:60686.32752
[114]	validation_0-rmse:50290.44458	validation_1-rmse:60726.99074
[115]	validation_0-rmse:50273.80406	validation_1-rmse:60756.00405
[116]	validation_0-rmse:50252.28375	validation_1-rmse:60745.33840
[117]	validation_0-rmse:50222.28266	validation_1-rmse:60752.40722
[118]	validation_0-rmse:50176.89156	validation_1-rmse:60760.49800
[119]	validation_0-rmse:50159.14972	validation_1-rmse:60765.48882
[120]	validation_0-rmse:50129.59374	validation_1-rmse:60746.32619
[121]	validation_0-rmse:50089.51661	validation_1-rmse:60713.23077
[122]	validation_0-rmse:50052.17556	validation_1-rmse:60699.68535
[123]	validation_0-rmse:50026.00466	validation_1-rmse:60737.78009
[124]	validation_0-rmse:49986.42141	validation_1-rmse:60756.18066
[125]	validation_0-rmse:49943.06041	validation_1-rmse:60752.48339
[126]	validation_0-rmse:49928.82671	validation_1-rmse:60739.34194
[127]	validation_0-rmse:49898.66453	validation_1-rmse:60783.39623
[128]	validation_0-rmse:49885.75364	validation_1-rmse:60790.51332
[129]	validation_0-rmse:49861.54808	validation_1-rmse:60790.07094
[130]	validation_0-rmse:49831.13265	validation_1-rmse:60815.24188
[131]	validation_0-rmse:49808.42304	validation_1-rmse:60826.85076
[132]	validation_0-rmse:49791.29258	validation_1-rmse:60841.38167
[133]	validation_0-rmse:49776.26732	validation_1-rmse:60816.51676
[134]	validation_0-rmse:49756.63158	validation_1-rmse:60825.38598
[135]	validation_0-rmse:49716.61807	validation_1-rmse:60861.37798
[136]	validation_0-rmse:49692.01169	validation_1-rmse:60894.35696
[137]	validation_0-rmse:49681.50175	validation_1-rmse:60865.43818
[138]	validation_0-rmse:49651.81810	validation_1-rmse:60841.27454
[139]	validation_0-rmse:49634.92533	validation_1-rmse:60858.26564
[140]	validation_0-rmse:49617.82125	validation_1-rmse:60852.25476
[141]	validation_0-rmse:49599.05616	validation_1-rmse:60855.08092
[142]	validation_0-rmse:49590.03513	validation_1-rmse:60858.29447
[143]	validation_0-rmse:49575.67815	validation_1-rmse:60866.09229
[144]	validation_0-rmse:49539.96986	validation_1-rmse:60854.33146
[145]	validation_0-rmse:49535.12819	validation_1-rmse:60847.48408
[146]	validation_0-rmse:49505.02574	validation_1-rmse:60867.09860
[147]	validation_0-rmse:49494.25469	validation_1-rmse:60902.91505
[148]	validation_0-rmse:49480.97574	validation_1-rmse:60917.81528
[149]	validation_0-rmse:49464.03310	validation_1-rmse:60964.80721
[150]	validation_0-rmse:49427.32679	validation_1-rmse:60982.92565
[151]	validation_0-rmse:49400.07895	validation_1-rmse:61001.97165
[152]	validation_0-rmse:49377.76339	validation_1-rmse:60951.14426
[153]	validation_0-rmse:49358.02691	validation_1-rmse:60965.42188
[154]	validation_0-rmse:49342.51173	validation_1-rmse:60974.62074
[155]	validation_0-rmse:49318.22179	validation_1-rmse:60977.25130
[156]	validation_0-rmse:49305.91595	validation_1-rmse:61010.90360
[157]	validation_0-rmse:49286.57855	validation_1-rmse:61021.04451
[158]	validation_0-rmse:49258.24933	validation_1-rmse:61065.98848
[159]	validation_0-rmse:49229.36014	validation_1-rmse:61088.55408
[160]	validation_0-rmse:49209.76932	validation_1-rmse:61138.00148
[161]	validation_0-rmse:49189.67123	validation_1-rmse:61145.91686
[162]	validation_0-rmse:49163.98034	validation_1-rmse:61124.46948
[163]	validation_0-rmse:49152.52142	validation_1-rmse:61111.18265
[164]	validation_0-rmse:49133.78064	validation_1-rmse:61134.97318
[165]	validation_0-rmse:49109.31533	validation_1-rmse:61138.01814
[166]	validation_0-rmse:49093.03004	validation_1-rmse:61147.91975
[167]	validation_0-rmse:49074.67076	validation_1-rmse:61158.20412
[168]	validation_0-rmse:49054.90047	validation_1-rmse:61183.98218
[169]	validation_0-rmse:49038.05464	validation_1-rmse:61214.78402
[170]	validation_0-rmse:49014.52792	validation_1-rmse:61252.11546
[171]	validation_0-rmse:48990.23771	validation_1-rmse:61267.47389
[172]	validation_0-rmse:48977.16778	validation_1-rmse:61267.62918
[173]	validation_0-rmse:48958.77181	validation_1-rmse:61277.66667
[174]	validation_0-rmse:48927.29013	validation_1-rmse:61272.11311
[175]	validation_0-rmse:48900.64097	validation_1-rmse:61267.34594
[176]	validation_0-rmse:48884.72075	validation_1-rmse:61256.97316
[177]	validation_0-rmse:48875.54613	validation_1-rmse:61264.86670
[178]	validation_0-rmse:48862.17761	validation_1-rmse:61262.41503
[179]	validation_0-rmse:48844.37654	validation_1-rmse:61278.94004
[180]	validation_0-rmse:48826.99525	validation_1-rmse:61288.46817
[181]	validation_0-rmse:48811.96855	validation_1-rmse:61316.39423
[182]	validation_0-rmse:48794.80759	validation_1-rmse:61322.25632
[183]	validation_0-rmse:48782.40419	validation_1-rmse:61333.96729
[184]	validation_0-rmse:48769.28018	validation_1-rmse:61337.82847
[185]	validation_0-rmse:48758.59131	validation_1-rmse:61340.34944
[186]	validation_0-rmse:48742.36787	validation_1-rmse:61349.41835
[187]	validation_0-rmse:48726.17564	validation_1-rmse:61361.04649
[188]	validation_0-rmse:48707.21956	validation_1-rmse:61347.43313
[189]	validation_0-rmse:48702.06279	validation_1-rmse:61357.79774
[190]	validation_0-rmse:48685.58657	validation_1-rmse:61358.24636
[191]	validation_0-rmse:48673.67823	validation_1-rmse:61351.83672
[192]	validation_0-rmse:48666.60302	validation_1-rmse:61348.31759
[193]	validation_0-rmse:48659.84924	validation_1-rmse:61360.97750
[194]	validation_0-rmse:48652.35305	validation_1-rmse:61366.98851
[195]	validation_0-rmse:48640.95678	validation_1-rmse:61387.68950
[196]	validation_0-rmse:48627.70333	validation_1-rmse:61377.83135
[197]	validation_0-rmse:48614.07579	validation_1-rmse:61376.90361
[198]	validation_0-rmse:48601.07214	validation_1-rmse:61367.68853
[199]	validation_0-rmse:48585.21968	validation_1-rmse:61377.64760

Training completed!

Training Metrics:
  MAE:  $36,237
  RMSE: $48,585
  R2:   0.6005
  MAPE: 26.32%
  Median AE: $28,914

Validation Metrics:
  MAE:  $41,472
  RMSE: $61,378
  R2:   0.4243
  MAPE: 27.71%
  Median AE: $30,602

Evaluating on test set...

Evaluating on 1793 test samples...

Test Metrics:
  MAE:  $40,637
  RMSE: $57,188
  R2:   0.4340
  MAPE: 28.34%
  Median AE: $30,566

Top 15 Most Important Features:
  company_tier_encoded: 0.1437
  is_director: 0.0930
  is_secondary_hub: 0.0905
  is_entry: 0.0548
  is_staff: 0.0458
  is_principal: 0.0450
  role_engineer: 0.0422
  role_analyst: 0.0398
  skill_deep_learning: 0.0368
  skill_count: 0.0352
  estimated_yoe: 0.0267
  role_scientist: 0.0259
  role_architect: 0.0240
  skill_computer_vision: 0.0221
  state_clean_encoded: 0.0215
Model saved to models/salary_model_20251206_220744.pkl

MLFlow run completed: fc8e65a7e0074e2ea36464d04d4dd03c

Model training complete!
