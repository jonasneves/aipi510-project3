/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/mlflow/tracking/_tracking_service/utils.py:140: FutureWarning: Filesystem tracking backend (e.g., './mlruns') is deprecated. Please switch to a database backend (e.g., 'sqlite:///mlflow.db'). For feedback, see: https://github.com/mlflow/mlflow/issues/18534
  return FileStore(store_uri, store_uri)
2025/11/26 19:43:48 INFO mlflow.tracking.fluent: Experiment with name 'salary_prediction' does not exist. Creating a new experiment.
2025-11-26 19:43:48,879 - DataMerger - INFO - Data merger initialized. Log file: logs/data_merge_20251126_194348.log
2025-11-26 19:43:48,879 - DataMerger - INFO - Applying training profile: all
2025-11-26 19:43:48,879 - DataMerger - INFO -   Description: Train on all available sources (H1B + LinkedIn + Adzuna)
2025-11-26 19:43:48,879 - DataMerger - INFO -   h1b: enabled
2025-11-26 19:43:48,879 - DataMerger - INFO -   adzuna: enabled
2025-11-26 19:43:48,879 - DataMerger - INFO -   linkedin: enabled
--- Model Training ---

MLFlow tracking URI: file:./mlruns
MLFlow experiment: salary_prediction

Loading data...

Using training profile: all
Loaded 14449 records from merged data

Filtering to recent data (last 2 years: 2024-2025)
  Kept 14405 / 14449 records (99.7%)
  Renaming location_state to worksite_state for feature engineering

Engineering features...

Prepared 13906 samples with 30 features
Target column: annual_salary

Creating train/test split...
  Train: 9734 samples (70.0%)
  Val:   2086 samples (15.0%)
  Test:  2086 samples (15.0%)

Training XGBoost model...
MLFlow run ID: 8129f955ef0548e3bd1d47c567af4767
Training XGBoost salary prediction model...
Training samples: 9734
Features: 29
Validation samples: 2086
[0]	validation_0-rmse:64218.63099	validation_1-rmse:65448.70863
[1]	validation_0-rmse:62957.84421	validation_1-rmse:64167.83620
[2]	validation_0-rmse:61131.67368	validation_1-rmse:62452.12812
[3]	validation_0-rmse:59505.25147	validation_1-rmse:60913.32406
[4]	validation_0-rmse:58822.61574	validation_1-rmse:60170.03493
[5]	validation_0-rmse:57615.55779	validation_1-rmse:58978.30509
[6]	validation_0-rmse:56502.52272	validation_1-rmse:57909.11646
[7]	validation_0-rmse:55613.12897	validation_1-rmse:57021.53014
[8]	validation_0-rmse:54814.16655	validation_1-rmse:56299.59118
[9]	validation_0-rmse:54158.03265	validation_1-rmse:55704.22611
[10]	validation_0-rmse:53558.42473	validation_1-rmse:55141.24562
[11]	validation_0-rmse:53035.79660	validation_1-rmse:54719.89750
[12]	validation_0-rmse:52624.02323	validation_1-rmse:54376.07518
[13]	validation_0-rmse:52200.66602	validation_1-rmse:54014.05325
[14]	validation_0-rmse:51860.48629	validation_1-rmse:53744.94491
[15]	validation_0-rmse:51603.33169	validation_1-rmse:53513.22766
[16]	validation_0-rmse:51348.22972	validation_1-rmse:53287.21966
[17]	validation_0-rmse:51060.92306	validation_1-rmse:53084.30188
[18]	validation_0-rmse:50841.14391	validation_1-rmse:52910.05852
[19]	validation_0-rmse:50663.85026	validation_1-rmse:52755.03324
[20]	validation_0-rmse:50377.54400	validation_1-rmse:52518.36597
[21]	validation_0-rmse:50177.12702	validation_1-rmse:52397.06546
[22]	validation_0-rmse:50006.40130	validation_1-rmse:52238.86106
[23]	validation_0-rmse:49849.02334	validation_1-rmse:52131.40897
[24]	validation_0-rmse:49700.51163	validation_1-rmse:52006.07853
[25]	validation_0-rmse:49531.25668	validation_1-rmse:51880.35439
[26]	validation_0-rmse:49429.59036	validation_1-rmse:51806.14243
[27]	validation_0-rmse:49271.29189	validation_1-rmse:51688.75939
[28]	validation_0-rmse:49194.87175	validation_1-rmse:51661.56280
[29]	validation_0-rmse:49106.22213	validation_1-rmse:51556.82283
[30]	validation_0-rmse:49017.44468	validation_1-rmse:51517.54378
[31]	validation_0-rmse:48885.75464	validation_1-rmse:51439.98733
[32]	validation_0-rmse:48804.56003	validation_1-rmse:51406.03292
[33]	validation_0-rmse:48736.88330	validation_1-rmse:51345.37320
[34]	validation_0-rmse:48665.11411	validation_1-rmse:51335.00013
[35]	validation_0-rmse:48611.39735	validation_1-rmse:51308.03307
[36]	validation_0-rmse:48566.64499	validation_1-rmse:51280.85216
[37]	validation_0-rmse:48485.41167	validation_1-rmse:51225.57186
[38]	validation_0-rmse:48428.27339	validation_1-rmse:51191.46912
[39]	validation_0-rmse:48374.75802	validation_1-rmse:51168.91391
[40]	validation_0-rmse:48309.80458	validation_1-rmse:51106.77618
[41]	validation_0-rmse:48249.80243	validation_1-rmse:51099.06143
[42]	validation_0-rmse:48166.48941	validation_1-rmse:51069.97947
[43]	validation_0-rmse:48118.82918	validation_1-rmse:51056.75325
[44]	validation_0-rmse:48098.32777	validation_1-rmse:51049.63748
[45]	validation_0-rmse:48063.27197	validation_1-rmse:51064.56846
[46]	validation_0-rmse:48015.93718	validation_1-rmse:51032.06981
[47]	validation_0-rmse:47983.56816	validation_1-rmse:51010.08448
[48]	validation_0-rmse:47924.89775	validation_1-rmse:50965.36671
[49]	validation_0-rmse:47886.21559	validation_1-rmse:50958.11499
[50]	validation_0-rmse:47851.48289	validation_1-rmse:50937.00294
[51]	validation_0-rmse:47821.72285	validation_1-rmse:50925.83905
[52]	validation_0-rmse:47784.17954	validation_1-rmse:50915.60049
[53]	validation_0-rmse:47742.50173	validation_1-rmse:50914.94926
[54]	validation_0-rmse:47705.24413	validation_1-rmse:50896.86843
[55]	validation_0-rmse:47670.05760	validation_1-rmse:50873.45968
[56]	validation_0-rmse:47634.46762	validation_1-rmse:50866.06283
[57]	validation_0-rmse:47583.83443	validation_1-rmse:50896.52760
[58]	validation_0-rmse:47558.88126	validation_1-rmse:50875.99579
[59]	validation_0-rmse:47525.38440	validation_1-rmse:50861.00305
[60]	validation_0-rmse:47487.36864	validation_1-rmse:50850.81622
[61]	validation_0-rmse:47458.10742	validation_1-rmse:50856.69003
[62]	validation_0-rmse:47422.11315	validation_1-rmse:50841.23305
[63]	validation_0-rmse:47403.07282	validation_1-rmse:50829.18431
[64]	validation_0-rmse:47361.96612	validation_1-rmse:50822.92325
[65]	validation_0-rmse:47342.46472	validation_1-rmse:50814.40404
[66]	validation_0-rmse:47323.29360	validation_1-rmse:50803.62597
[67]	validation_0-rmse:47303.09593	validation_1-rmse:50803.96537
[68]	validation_0-rmse:47281.01769	validation_1-rmse:50807.69397
[69]	validation_0-rmse:47259.37849	validation_1-rmse:50804.37354
[70]	validation_0-rmse:47218.30508	validation_1-rmse:50800.52538
[71]	validation_0-rmse:47203.98034	validation_1-rmse:50803.87592
[72]	validation_0-rmse:47179.62104	validation_1-rmse:50792.72955
[73]	validation_0-rmse:47159.98311	validation_1-rmse:50795.01959
[74]	validation_0-rmse:47146.17245	validation_1-rmse:50808.60302
[75]	validation_0-rmse:47127.72787	validation_1-rmse:50805.15538
[76]	validation_0-rmse:47106.29899	validation_1-rmse:50801.24295
[77]	validation_0-rmse:47089.05968	validation_1-rmse:50796.67939
[78]	validation_0-rmse:47063.75461	validation_1-rmse:50802.76561
[79]	validation_0-rmse:47046.55201	validation_1-rmse:50807.23134
[80]	validation_0-rmse:47034.15864	validation_1-rmse:50797.03779
[81]	validation_0-rmse:47014.25598	validation_1-rmse:50809.40261
[82]	validation_0-rmse:46991.59664	validation_1-rmse:50805.80427
[83]	validation_0-rmse:46972.55195	validation_1-rmse:50805.42819
[84]	validation_0-rmse:46951.71025	validation_1-rmse:50790.73183
[85]	validation_0-rmse:46940.60271	validation_1-rmse:50782.21791
[86]	validation_0-rmse:46912.20180	validation_1-rmse:50770.74461
[87]	validation_0-rmse:46902.88665	validation_1-rmse:50766.62307
[88]	validation_0-rmse:46887.57426	validation_1-rmse:50764.85300
[89]	validation_0-rmse:46870.75711	validation_1-rmse:50753.80433
[90]	validation_0-rmse:46853.55753	validation_1-rmse:50765.14626
[91]	validation_0-rmse:46837.16185	validation_1-rmse:50767.65135
[92]	validation_0-rmse:46821.80905	validation_1-rmse:50762.57313
[93]	validation_0-rmse:46807.33041	validation_1-rmse:50763.02601
[94]	validation_0-rmse:46790.12734	validation_1-rmse:50749.49259
[95]	validation_0-rmse:46766.57552	validation_1-rmse:50741.35366
[96]	validation_0-rmse:46753.79536	validation_1-rmse:50740.84150
[97]	validation_0-rmse:46738.63818	validation_1-rmse:50740.74845
[98]	validation_0-rmse:46729.92354	validation_1-rmse:50733.75944
[99]	validation_0-rmse:46714.66221	validation_1-rmse:50732.37691
[100]	validation_0-rmse:46705.18284	validation_1-rmse:50731.89885
[101]	validation_0-rmse:46694.54988	validation_1-rmse:50732.74556
[102]	validation_0-rmse:46682.34097	validation_1-rmse:50747.87887
[103]	validation_0-rmse:46671.27754	validation_1-rmse:50752.63534
[104]	validation_0-rmse:46662.65350	validation_1-rmse:50759.13688
[105]	validation_0-rmse:46654.36184	validation_1-rmse:50760.91971
[106]	validation_0-rmse:46640.12587	validation_1-rmse:50778.37912
[107]	validation_0-rmse:46625.42937	validation_1-rmse:50782.01045
[108]	validation_0-rmse:46619.85172	validation_1-rmse:50786.46439
[109]	validation_0-rmse:46610.70206	validation_1-rmse:50791.62117
[110]	validation_0-rmse:46594.38373	validation_1-rmse:50801.20895
[111]	validation_0-rmse:46577.05167	validation_1-rmse:50800.47464
[112]	validation_0-rmse:46561.28346	validation_1-rmse:50814.90568
[113]	validation_0-rmse:46552.82961	validation_1-rmse:50817.13997
[114]	validation_0-rmse:46536.92656	validation_1-rmse:50820.31337
[115]	validation_0-rmse:46526.01137	validation_1-rmse:50817.81740
[116]	validation_0-rmse:46507.41347	validation_1-rmse:50800.79276
[117]	validation_0-rmse:46491.26731	validation_1-rmse:50814.62109
[118]	validation_0-rmse:46472.93710	validation_1-rmse:50808.66551
[119]	validation_0-rmse:46466.52110	validation_1-rmse:50822.02270
[120]	validation_0-rmse:46445.45840	validation_1-rmse:50823.24769
[121]	validation_0-rmse:46438.58649	validation_1-rmse:50825.18668
[122]	validation_0-rmse:46431.92802	validation_1-rmse:50810.27479
[123]	validation_0-rmse:46420.86677	validation_1-rmse:50803.28035
[124]	validation_0-rmse:46407.13161	validation_1-rmse:50810.77159
[125]	validation_0-rmse:46398.43682	validation_1-rmse:50832.06384
[126]	validation_0-rmse:46386.77604	validation_1-rmse:50817.74860
[127]	validation_0-rmse:46377.56016	validation_1-rmse:50821.84138
[128]	validation_0-rmse:46367.08410	validation_1-rmse:50837.15166
[129]	validation_0-rmse:46350.66186	validation_1-rmse:50839.73873
[130]	validation_0-rmse:46335.80575	validation_1-rmse:50845.77552
[131]	validation_0-rmse:46326.73390	validation_1-rmse:50855.84757
[132]	validation_0-rmse:46310.72771	validation_1-rmse:50865.13013
[133]	validation_0-rmse:46299.51831	validation_1-rmse:50866.92615
[134]	validation_0-rmse:46291.83067	validation_1-rmse:50878.41987
[135]	validation_0-rmse:46286.50636	validation_1-rmse:50890.67783
[136]	validation_0-rmse:46274.03171	validation_1-rmse:50882.73905
[137]	validation_0-rmse:46266.66117	validation_1-rmse:50884.46656
[138]	validation_0-rmse:46255.35450	validation_1-rmse:50887.84873
[139]	validation_0-rmse:46247.18759	validation_1-rmse:50887.51656
[140]	validation_0-rmse:46243.79635	validation_1-rmse:50880.58983
[141]	validation_0-rmse:46236.41307	validation_1-rmse:50883.23123
[142]	validation_0-rmse:46224.27219	validation_1-rmse:50879.56604
[143]	validation_0-rmse:46216.65423	validation_1-rmse:50888.46852
[144]	validation_0-rmse:46200.51150	validation_1-rmse:50906.34512
[145]	validation_0-rmse:46194.84065	validation_1-rmse:50907.96652
[146]	validation_0-rmse:46186.82861	validation_1-rmse:50929.30418
[147]	validation_0-rmse:46184.48783	validation_1-rmse:50926.80177
[148]	validation_0-rmse:46176.13167	validation_1-rmse:50924.50625
[149]	validation_0-rmse:46163.89031	validation_1-rmse:50923.48711
[150]	validation_0-rmse:46155.75488	validation_1-rmse:50923.14319
[151]	validation_0-rmse:46139.88869	validation_1-rmse:50919.11529
[152]	validation_0-rmse:46133.67184	validation_1-rmse:50937.04793
[153]	validation_0-rmse:46125.22987	validation_1-rmse:50940.45805
[154]	validation_0-rmse:46119.31758	validation_1-rmse:50940.96320
[155]	validation_0-rmse:46115.96485	validation_1-rmse:50949.88796
[156]	validation_0-rmse:46107.59355	validation_1-rmse:50949.11195
[157]	validation_0-rmse:46102.20653	validation_1-rmse:50950.09012
[158]	validation_0-rmse:46093.34391	validation_1-rmse:50943.11965
[159]	validation_0-rmse:46089.05221	validation_1-rmse:50947.90897
[160]	validation_0-rmse:46079.54485	validation_1-rmse:50944.13610
[161]	validation_0-rmse:46078.73606	validation_1-rmse:50944.47403
[162]	validation_0-rmse:46070.09481	validation_1-rmse:50944.60798
[163]	validation_0-rmse:46062.20349	validation_1-rmse:50933.50927
[164]	validation_0-rmse:46054.46390	validation_1-rmse:50929.81438
[165]	validation_0-rmse:46046.84409	validation_1-rmse:50924.10639
[166]	validation_0-rmse:46042.86553	validation_1-rmse:50926.86221
[167]	validation_0-rmse:46038.75816	validation_1-rmse:50930.38795
[168]	validation_0-rmse:46031.73948	validation_1-rmse:50928.90378
[169]	validation_0-rmse:46027.34600	validation_1-rmse:50925.64643
[170]	validation_0-rmse:46017.34862	validation_1-rmse:50932.13063
[171]	validation_0-rmse:46011.78548	validation_1-rmse:50938.11360
[172]	validation_0-rmse:46001.01361	validation_1-rmse:50956.51197
[173]	validation_0-rmse:45995.80589	validation_1-rmse:50965.23798
[174]	validation_0-rmse:45988.72858	validation_1-rmse:50967.32701
[175]	validation_0-rmse:45978.28313	validation_1-rmse:50966.11000
[176]	validation_0-rmse:45970.53130	validation_1-rmse:50972.32005
[177]	validation_0-rmse:45954.69097	validation_1-rmse:50975.37687
[178]	validation_0-rmse:45950.78199	validation_1-rmse:50980.94336
[179]	validation_0-rmse:45943.94089	validation_1-rmse:50973.41672
[180]	validation_0-rmse:45938.92542	validation_1-rmse:50976.64643
[181]	validation_0-rmse:45931.35651	validation_1-rmse:50977.03135
[182]	validation_0-rmse:45920.86179	validation_1-rmse:50996.98425
[183]	validation_0-rmse:45912.80426	validation_1-rmse:50996.71713
[184]	validation_0-rmse:45906.77127	validation_1-rmse:51016.64910
[185]	validation_0-rmse:45898.23393	validation_1-rmse:51019.90727
[186]	validation_0-rmse:45892.09184	validation_1-rmse:51024.31844
[187]	validation_0-rmse:45885.55362	validation_1-rmse:51026.67404
[188]	validation_0-rmse:45879.47615	validation_1-rmse:51035.34321
[189]	validation_0-rmse:45874.31827	validation_1-rmse:51039.15588
[190]	validation_0-rmse:45871.68536	validation_1-rmse:51043.80255
[191]	validation_0-rmse:45866.86017	validation_1-rmse:51049.30049
[192]	validation_0-rmse:45863.53201	validation_1-rmse:51065.82528
[193]	validation_0-rmse:45859.04261	validation_1-rmse:51078.47411
[194]	validation_0-rmse:45854.19144	validation_1-rmse:51091.05319
[195]	validation_0-rmse:45851.31990	validation_1-rmse:51109.35551
[196]	validation_0-rmse:45848.02115	validation_1-rmse:51109.91592
[197]	validation_0-rmse:45839.19185	validation_1-rmse:51103.90782
[198]	validation_0-rmse:45832.59041	validation_1-rmse:51096.36916
[199]	validation_0-rmse:45829.90983	validation_1-rmse:51095.23113

Training completed!

Training Metrics:
  MAE:  $34,076
  RMSE: $45,830
  R2:   0.5227
  MAPE: 25.91%
  Median AE: $26,973

Validation Metrics:
  MAE:  $37,959
  RMSE: $51,095
  R2:   0.4271
  MAPE: 28.37%
  Median AE: $30,497

Evaluating on test set...

Evaluating on 2086 test samples...

Test Metrics:
  MAE:  $36,255
  RMSE: $47,604
  R2:   0.4462
  MAPE: 28.12%
  Median AE: $29,261

Top 15 Most Important Features:
  company_tier_encoded: 0.1760
  is_director: 0.0946
  is_entry: 0.0897
  role_engineer: 0.0623
  is_secondary_hub: 0.0604
  is_staff: 0.0598
  is_major_tech_hub: 0.0490
  is_principal: 0.0489
  role_analyst: 0.0339
  role_architect: 0.0270
  role_scientist: 0.0264
  year: 0.0244
  is_lead: 0.0233
  is_manager: 0.0232
  is_senior: 0.0227
Model saved to models/salary_model_20251126_194357.pkl

MLFlow run completed: 8129f955ef0548e3bd1d47c567af4767

Model training complete!
