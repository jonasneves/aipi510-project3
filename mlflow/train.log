/opt/hostedtoolcache/Python/3.11.14/arm64/lib/python3.11/site-packages/mlflow/tracking/_tracking_service/utils.py:178: FutureWarning: The filesystem tracking backend (e.g., './mlruns') will be deprecated in February 2026. Consider transitioning to a database backend (e.g., 'sqlite:///mlflow.db') to take advantage of the latest MLflow features. See https://github.com/mlflow/mlflow/issues/18534 for more details and migration guidance. For migrating existing data, https://github.com/mlflow/mlflow-export-import can be used.
  return FileStore(store_uri, store_uri)
2026/02/04 05:37:05 INFO mlflow.tracking.fluent: Experiment with name 'salary_prediction' does not exist. Creating a new experiment.
2026-02-04 05:37:05,216 - DataMerger - INFO - Data merger initialized. Log file: logs/data_merge_20260204_053705.log
2026-02-04 05:37:05,216 - DataMerger - INFO - Applying training profile: all
2026-02-04 05:37:05,216 - DataMerger - INFO -   Description: Train on all available sources (H1B + LinkedIn + Adzuna)
2026-02-04 05:37:05,216 - DataMerger - INFO -   h1b: enabled
2026-02-04 05:37:05,216 - DataMerger - INFO -   adzuna: enabled
2026-02-04 05:37:05,216 - DataMerger - INFO -   linkedin: enabled
--- Model Training ---

MLFlow tracking URI: file:./mlruns
MLFlow experiment: salary_prediction

Loading data...

Using training profile: all
Loaded 37266 records from merged data

Filtering to recent data (last 2 years: 2025-2026)
  Kept 26715 / 37266 records (71.7%)
  Renaming location_state to worksite_state for feature engineering

Engineering features...

Prepared 26441 samples with 30 features
Target column: annual_salary

Creating train/test split...
  Train: 18507 samples (70.0%)
  Val:   3967 samples (15.0%)
  Test:  3967 samples (15.0%)

Training XGBoost model...
MLFlow run ID: dd22d3a0c9f444bf875bf04efb25a384
Training XGBoost salary prediction model...
Training samples: 18507
Features: 29
Validation samples: 3967
[0]	validation_0-rmse:110191.40130	validation_1-rmse:108541.02588
[1]	validation_0-rmse:107123.77919	validation_1-rmse:105596.92839
[2]	validation_0-rmse:103114.23394	validation_1-rmse:102034.04181
[3]	validation_0-rmse:100095.32296	validation_1-rmse:99505.41571
[4]	validation_0-rmse:98302.42853	validation_1-rmse:97757.68429
[5]	validation_0-rmse:95796.59787	validation_1-rmse:95458.79341
[6]	validation_0-rmse:93468.55075	validation_1-rmse:93336.61642
[7]	validation_0-rmse:91525.44063	validation_1-rmse:91565.05000
[8]	validation_0-rmse:89915.87516	validation_1-rmse:90100.37670
[9]	validation_0-rmse:88634.29002	validation_1-rmse:88997.01396
[10]	validation_0-rmse:87552.01872	validation_1-rmse:87987.65290
[11]	validation_0-rmse:86353.67003	validation_1-rmse:86919.17798
[12]	validation_0-rmse:85269.69480	validation_1-rmse:85898.88122
[13]	validation_0-rmse:84411.45015	validation_1-rmse:85054.34619
[14]	validation_0-rmse:83454.81085	validation_1-rmse:84157.32828
[15]	validation_0-rmse:82959.20554	validation_1-rmse:83634.54910
[16]	validation_0-rmse:82228.41793	validation_1-rmse:82996.02785
[17]	validation_0-rmse:81540.17051	validation_1-rmse:82433.63202
[18]	validation_0-rmse:81047.38850	validation_1-rmse:82006.82753
[19]	validation_0-rmse:80670.74979	validation_1-rmse:81599.49183
[20]	validation_0-rmse:80080.48906	validation_1-rmse:80971.41354
[21]	validation_0-rmse:79479.83019	validation_1-rmse:80413.85801
[22]	validation_0-rmse:79061.10281	validation_1-rmse:80010.18530
[23]	validation_0-rmse:78515.83031	validation_1-rmse:79519.73986
[24]	validation_0-rmse:78132.19543	validation_1-rmse:79169.62539
[25]	validation_0-rmse:77727.96244	validation_1-rmse:78820.97330
[26]	validation_0-rmse:77418.54964	validation_1-rmse:78560.59850
[27]	validation_0-rmse:76600.80354	validation_1-rmse:77857.82821
[28]	validation_0-rmse:76409.68983	validation_1-rmse:77666.36693
[29]	validation_0-rmse:76191.69973	validation_1-rmse:77476.87728
[30]	validation_0-rmse:75998.47131	validation_1-rmse:77303.56611
[31]	validation_0-rmse:75902.88528	validation_1-rmse:77216.21482
[32]	validation_0-rmse:75385.97780	validation_1-rmse:76798.51210
[33]	validation_0-rmse:75199.50512	validation_1-rmse:76622.94738
[34]	validation_0-rmse:74807.74813	validation_1-rmse:76276.34315
[35]	validation_0-rmse:74721.14195	validation_1-rmse:76200.69529
[36]	validation_0-rmse:74206.81175	validation_1-rmse:75697.25514
[37]	validation_0-rmse:73861.41139	validation_1-rmse:75431.17985
[38]	validation_0-rmse:73594.80283	validation_1-rmse:75222.15074
[39]	validation_0-rmse:73206.54140	validation_1-rmse:74903.67252
[40]	validation_0-rmse:72937.02672	validation_1-rmse:74689.65193
[41]	validation_0-rmse:72726.66164	validation_1-rmse:74539.67684
[42]	validation_0-rmse:72595.42475	validation_1-rmse:74420.73179
[43]	validation_0-rmse:72393.05227	validation_1-rmse:74234.14677
[44]	validation_0-rmse:72177.48195	validation_1-rmse:74065.41959
[45]	validation_0-rmse:71948.69932	validation_1-rmse:73879.21404
[46]	validation_0-rmse:71670.41868	validation_1-rmse:73699.17226
[47]	validation_0-rmse:71356.19524	validation_1-rmse:73411.04941
[48]	validation_0-rmse:71228.83456	validation_1-rmse:73260.41584
[49]	validation_0-rmse:71167.81974	validation_1-rmse:73189.60396
[50]	validation_0-rmse:71017.23408	validation_1-rmse:73083.35335
[51]	validation_0-rmse:70844.84065	validation_1-rmse:72955.11104
[52]	validation_0-rmse:70646.83641	validation_1-rmse:72750.70885
[53]	validation_0-rmse:70560.48391	validation_1-rmse:72695.01666
[54]	validation_0-rmse:70477.80047	validation_1-rmse:72628.23315
[55]	validation_0-rmse:70204.20158	validation_1-rmse:72382.92040
[56]	validation_0-rmse:69994.74894	validation_1-rmse:72198.98547
[57]	validation_0-rmse:69778.77614	validation_1-rmse:71999.09742
[58]	validation_0-rmse:69451.75161	validation_1-rmse:71784.33389
[59]	validation_0-rmse:69381.22381	validation_1-rmse:71731.42287
[60]	validation_0-rmse:69196.41950	validation_1-rmse:71578.24663
[61]	validation_0-rmse:69070.09238	validation_1-rmse:71461.40782
[62]	validation_0-rmse:68996.08230	validation_1-rmse:71389.01104
[63]	validation_0-rmse:68929.69267	validation_1-rmse:71351.09189
[64]	validation_0-rmse:68877.77178	validation_1-rmse:71315.79894
[65]	validation_0-rmse:68639.71727	validation_1-rmse:71120.12551
[66]	validation_0-rmse:68519.52735	validation_1-rmse:71039.73871
[67]	validation_0-rmse:68373.94667	validation_1-rmse:70913.85833
[68]	validation_0-rmse:68234.51083	validation_1-rmse:70803.42021
[69]	validation_0-rmse:68194.74071	validation_1-rmse:70780.12002
[70]	validation_0-rmse:68106.44907	validation_1-rmse:70696.85705
[71]	validation_0-rmse:67935.55965	validation_1-rmse:70606.72428
[72]	validation_0-rmse:67520.55603	validation_1-rmse:70252.59115
[73]	validation_0-rmse:67246.23508	validation_1-rmse:70060.54374
[74]	validation_0-rmse:67111.31107	validation_1-rmse:69897.75914
[75]	validation_0-rmse:67007.92793	validation_1-rmse:69818.37901
[76]	validation_0-rmse:66659.39907	validation_1-rmse:69515.84381
[77]	validation_0-rmse:66609.77699	validation_1-rmse:69459.80578
[78]	validation_0-rmse:66420.24755	validation_1-rmse:69280.28770
[79]	validation_0-rmse:66249.47236	validation_1-rmse:69126.10948
[80]	validation_0-rmse:66080.34364	validation_1-rmse:69005.33787
[81]	validation_0-rmse:66002.13261	validation_1-rmse:68929.39565
[82]	validation_0-rmse:65884.13828	validation_1-rmse:68835.72317
[83]	validation_0-rmse:65720.09124	validation_1-rmse:68683.40198
[84]	validation_0-rmse:65519.22065	validation_1-rmse:68545.01028
[85]	validation_0-rmse:65455.13877	validation_1-rmse:68483.48286
[86]	validation_0-rmse:65275.00666	validation_1-rmse:68307.06724
[87]	validation_0-rmse:65207.07939	validation_1-rmse:68259.64433
[88]	validation_0-rmse:64981.57102	validation_1-rmse:68048.80175
[89]	validation_0-rmse:64928.92532	validation_1-rmse:67992.18536
[90]	validation_0-rmse:64888.97837	validation_1-rmse:67957.93007
[91]	validation_0-rmse:64741.39749	validation_1-rmse:67823.45083
[92]	validation_0-rmse:64622.04456	validation_1-rmse:67712.53249
[93]	validation_0-rmse:64371.75772	validation_1-rmse:67506.41586
[94]	validation_0-rmse:64265.32104	validation_1-rmse:67406.44889
[95]	validation_0-rmse:64180.52573	validation_1-rmse:67357.45045
[96]	validation_0-rmse:64081.49387	validation_1-rmse:67275.58379
[97]	validation_0-rmse:64011.17288	validation_1-rmse:67220.87140
[98]	validation_0-rmse:63922.23922	validation_1-rmse:67158.61774
[99]	validation_0-rmse:63784.30540	validation_1-rmse:67062.87891
[100]	validation_0-rmse:63765.17875	validation_1-rmse:67067.40839
[101]	validation_0-rmse:63551.54715	validation_1-rmse:66902.55685
[102]	validation_0-rmse:63409.87482	validation_1-rmse:66751.93518
[103]	validation_0-rmse:63142.28880	validation_1-rmse:66554.96642
[104]	validation_0-rmse:63128.37024	validation_1-rmse:66539.63668
[105]	validation_0-rmse:63059.44629	validation_1-rmse:66487.73036
[106]	validation_0-rmse:62978.65983	validation_1-rmse:66451.17102
[107]	validation_0-rmse:62856.96769	validation_1-rmse:66369.12564
[108]	validation_0-rmse:62735.42717	validation_1-rmse:66281.52676
[109]	validation_0-rmse:62551.98662	validation_1-rmse:66147.29822
[110]	validation_0-rmse:62360.49834	validation_1-rmse:66016.67746
[111]	validation_0-rmse:62238.19523	validation_1-rmse:65910.02407
[112]	validation_0-rmse:62073.11230	validation_1-rmse:65801.45041
[113]	validation_0-rmse:62000.65333	validation_1-rmse:65728.59529
[114]	validation_0-rmse:61922.96224	validation_1-rmse:65694.86142
[115]	validation_0-rmse:61883.73099	validation_1-rmse:65666.05844
[116]	validation_0-rmse:61774.82813	validation_1-rmse:65614.71814
[117]	validation_0-rmse:61576.45780	validation_1-rmse:65432.90489
[118]	validation_0-rmse:61499.52183	validation_1-rmse:65320.84061
[119]	validation_0-rmse:61476.95279	validation_1-rmse:65303.93379
[120]	validation_0-rmse:61392.54527	validation_1-rmse:65246.83671
[121]	validation_0-rmse:61226.64892	validation_1-rmse:65149.61131
[122]	validation_0-rmse:61206.27243	validation_1-rmse:65129.96194
[123]	validation_0-rmse:61097.50671	validation_1-rmse:65060.22298
[124]	validation_0-rmse:61030.37915	validation_1-rmse:65013.42512
[125]	validation_0-rmse:60954.72619	validation_1-rmse:64953.30926
[126]	validation_0-rmse:60913.44006	validation_1-rmse:64936.86771
[127]	validation_0-rmse:60788.45972	validation_1-rmse:64865.23707
[128]	validation_0-rmse:60730.03245	validation_1-rmse:64807.38136
[129]	validation_0-rmse:60617.77046	validation_1-rmse:64732.36963
[130]	validation_0-rmse:60519.33153	validation_1-rmse:64595.02469
[131]	validation_0-rmse:60445.71355	validation_1-rmse:64548.54689
[132]	validation_0-rmse:60296.97245	validation_1-rmse:64455.00653
[133]	validation_0-rmse:60190.34290	validation_1-rmse:64379.81751
[134]	validation_0-rmse:60145.85457	validation_1-rmse:64345.01021
[135]	validation_0-rmse:60015.01199	validation_1-rmse:64190.36035
[136]	validation_0-rmse:59909.03026	validation_1-rmse:64106.19183
[137]	validation_0-rmse:59824.68827	validation_1-rmse:64052.87224
[138]	validation_0-rmse:59782.02530	validation_1-rmse:64004.31256
[139]	validation_0-rmse:59673.79495	validation_1-rmse:63926.02339
[140]	validation_0-rmse:59551.49358	validation_1-rmse:63830.77229
[141]	validation_0-rmse:59534.49744	validation_1-rmse:63823.51976
[142]	validation_0-rmse:59412.27763	validation_1-rmse:63701.62231
[143]	validation_0-rmse:59328.62720	validation_1-rmse:63643.80954
[144]	validation_0-rmse:59222.33673	validation_1-rmse:63532.54989
[145]	validation_0-rmse:59191.86843	validation_1-rmse:63499.30116
[146]	validation_0-rmse:59082.71762	validation_1-rmse:63430.23799
[147]	validation_0-rmse:59025.69762	validation_1-rmse:63388.36353
[148]	validation_0-rmse:58946.27889	validation_1-rmse:63331.19205
[149]	validation_0-rmse:58913.13100	validation_1-rmse:63297.22886
[150]	validation_0-rmse:58860.31761	validation_1-rmse:63257.76860
[151]	validation_0-rmse:58803.51799	validation_1-rmse:63199.07473
[152]	validation_0-rmse:58761.08074	validation_1-rmse:63146.40609
[153]	validation_0-rmse:58697.35823	validation_1-rmse:63088.94264
[154]	validation_0-rmse:58645.34832	validation_1-rmse:63048.60838
[155]	validation_0-rmse:58583.44347	validation_1-rmse:62986.24766
[156]	validation_0-rmse:58467.68677	validation_1-rmse:62920.13007
[157]	validation_0-rmse:58426.29792	validation_1-rmse:62883.74190
[158]	validation_0-rmse:58330.92747	validation_1-rmse:62817.44271
[159]	validation_0-rmse:58258.67293	validation_1-rmse:62744.57913
[160]	validation_0-rmse:58156.23632	validation_1-rmse:62658.41702
[161]	validation_0-rmse:58056.75701	validation_1-rmse:62570.67789
[162]	validation_0-rmse:57984.60041	validation_1-rmse:62516.76780
[163]	validation_0-rmse:57884.84764	validation_1-rmse:62420.13397
[164]	validation_0-rmse:57830.35456	validation_1-rmse:62377.48854
[165]	validation_0-rmse:57761.08527	validation_1-rmse:62316.16040
[166]	validation_0-rmse:57697.74732	validation_1-rmse:62271.81773
[167]	validation_0-rmse:57628.23024	validation_1-rmse:62211.08262
[168]	validation_0-rmse:57572.02995	validation_1-rmse:62157.98855
[169]	validation_0-rmse:57464.40532	validation_1-rmse:62029.48970
[170]	validation_0-rmse:57418.32404	validation_1-rmse:62003.14741
[171]	validation_0-rmse:57387.48072	validation_1-rmse:61990.35268
[172]	validation_0-rmse:57310.28850	validation_1-rmse:61919.03922
[173]	validation_0-rmse:57273.66330	validation_1-rmse:61886.08234
[174]	validation_0-rmse:57197.46466	validation_1-rmse:61853.79398
[175]	validation_0-rmse:57148.22469	validation_1-rmse:61824.14475
[176]	validation_0-rmse:57062.68168	validation_1-rmse:61743.69295
[177]	validation_0-rmse:56988.43381	validation_1-rmse:61673.50286
[178]	validation_0-rmse:56907.80094	validation_1-rmse:61582.03380
[179]	validation_0-rmse:56852.62685	validation_1-rmse:61530.01196
[180]	validation_0-rmse:56780.05089	validation_1-rmse:61490.01941
[181]	validation_0-rmse:56732.12157	validation_1-rmse:61435.15644
[182]	validation_0-rmse:56656.75825	validation_1-rmse:61348.11243
[183]	validation_0-rmse:56638.77009	validation_1-rmse:61336.58903
[184]	validation_0-rmse:56605.74966	validation_1-rmse:61310.97581
[185]	validation_0-rmse:56538.03841	validation_1-rmse:61266.80459
[186]	validation_0-rmse:56437.66615	validation_1-rmse:61189.53152
[187]	validation_0-rmse:56370.81284	validation_1-rmse:61115.74043
[188]	validation_0-rmse:56333.86672	validation_1-rmse:61096.96018
[189]	validation_0-rmse:56254.47094	validation_1-rmse:61037.51679
[190]	validation_0-rmse:56196.94945	validation_1-rmse:60989.99970
[191]	validation_0-rmse:56135.67684	validation_1-rmse:60914.42933
[192]	validation_0-rmse:56103.12723	validation_1-rmse:60897.88321
[193]	validation_0-rmse:56089.28260	validation_1-rmse:60885.82669
[194]	validation_0-rmse:56048.59166	validation_1-rmse:60859.16278
[195]	validation_0-rmse:56000.42644	validation_1-rmse:60839.78766
[196]	validation_0-rmse:55955.06745	validation_1-rmse:60822.26261
[197]	validation_0-rmse:55925.67514	validation_1-rmse:60795.06295
[198]	validation_0-rmse:55884.32913	validation_1-rmse:60770.72230
[199]	validation_0-rmse:55830.23966	validation_1-rmse:60738.25612

Training completed!

Training Metrics:
  MAE:  $36,626
  RMSE: $55,830
  R2:   0.7644
  MAPE: 21.44%
  Median AE: $23,689

Validation Metrics:
  MAE:  $38,778
  RMSE: $60,738
  R2:   0.7105
  MAPE: 22.12%
  Median AE: $24,338

Evaluating on test set...

Evaluating on 3967 test samples...

Test Metrics:
  MAE:  $39,472
  RMSE: $61,890
  R2:   0.7072
  MAPE: 22.89%
  Median AE: $25,733

Top 15 Most Important Features:
  company_tier_encoded: 0.1233
  is_principal: 0.0824
  role_architect: 0.0791
  is_entry: 0.0562
  skill_deep_learning: 0.0521
  estimated_yoe: 0.0400
  is_staff: 0.0384
  state_clean_encoded: 0.0335
  is_senior: 0.0317
  is_director: 0.0309
  skill_count: 0.0294
  is_remote_friendly: 0.0290
  skill_mlops: 0.0290
  skill_data_engineering: 0.0288
  is_manager: 0.0286
Model saved to models/salary_model_20260204_053715.pkl

MLFlow run completed: dd22d3a0c9f444bf875bf04efb25a384

Model training complete!
